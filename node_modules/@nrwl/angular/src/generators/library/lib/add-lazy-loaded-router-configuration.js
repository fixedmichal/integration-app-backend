"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.addLazyLoadedRouterConfiguration = void 0;
const devkit_1 = require("@nrwl/devkit");
const ast_utils_1 = require("@nrwl/workspace/src/utilities/ast-utils");
const ts = require("typescript");
const ast_utils_2 = require("../../../utils/nx-devkit/ast-utils");
const path_1 = require("path");
function addLazyLoadedRouterConfiguration(tree, options) {
    const constName = `${(0, devkit_1.names)(options.fileName).propertyName}Routes`;
    tree.write((0, devkit_1.joinPathFragments)((0, path_1.dirname)(options.modulePath), 'lib.routes.ts'), `import { Route } from '@angular/router';

export const ${constName}: Route[] = [/* {path: '', pathMatch: 'full', component: InsertYourComponentHere} */];`);
    const routeFileSource = tree.read(options.modulePath, 'utf-8');
    let sourceFile = ts.createSourceFile(options.modulePath, routeFileSource, ts.ScriptTarget.Latest, true);
    sourceFile = (0, ast_utils_2.addImportToModule)(tree, sourceFile, options.modulePath, `
    RouterModule.forChild(${constName}) `);
    sourceFile = (0, ast_utils_1.insertImport)(tree, sourceFile, options.modulePath, 'RouterModule', '@angular/router');
    sourceFile = (0, ast_utils_1.insertImport)(tree, sourceFile, options.modulePath, constName, './lib.routes');
    const pathToIndex = (0, devkit_1.joinPathFragments)(options.projectRoot, 'src/index.ts');
    const indexFileContents = tree.read(pathToIndex, 'utf-8');
    tree.write(pathToIndex, `${indexFileContents}
  export * from './lib/lib.routes';`);
}
exports.addLazyLoadedRouterConfiguration = addLazyLoadedRouterConfiguration;
//# sourceMappingURL=add-lazy-loaded-router-configuration.js.map